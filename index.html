<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0">
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<title>跳轉中，請稍後</title>
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-P3W6RGX');</script>
<!-- End Google Tag Manager -->	
</head>
<style>
	*{
		margin: 0;
		padding: 0;
	}
	body{
		position: relative;
	}
	h2{
		width: 95%;
		height: 50px;
		font-size: 1.5em;
		line-height: 50px;
		text-align: center;
		margin: auto;
		position: fixed;
		left: 0;
		top:0;
		right:0;
		bottom:0;
		z-index: 99;
	}
</style>
<body>
	<h2>跳轉中，請稍後...</h2>	
</body>
</html>
<script>
     var dataSet = {
		//等待時間---勿動
		redirected : false,

		//用戶無安裝APP時，欲設定的連結
		noInstallAppLink_:'https://my.taishinbank.com.tw/WB/app/',
			
		//pc時欲設定的連結
		pcLink:'https://my.taishinbank.com.tw/TIBNetBank/nb.jsp?PageURI=240',
			
		//手機時欲設定的連結
		mobileLink:'https://mkp.taishinbank.com.tw/TsCms/coupon/tsbcoupon.html?couponCode=CP_20220425162343029&openExternalBrowser=1'
	 };
	
	function getParameterByName(name) {
	name = name.replace(/[\[\]]/g, '\\$&');
	var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'), results = regex
			.exec(dataSet.mobileLink);
	if (!results)
		return null;
	if (!results[2])
		return '';
	return decodeURIComponent(results[2].replace(/\+/g, ' '));
}
function openIosApp(allQueryString) {
	var redirectUrl = 'tsmb:///discount/couponDetail' +allQueryString;
	setTimeout(function() {
		if (!document.webkitHidden) {
			window.location = dataSet.noInstallAppLink;
		}
	}, 25);
	window.location = encodeURI(redirectUrl);
}
function openAndroidApp(allQueryString) {
	var redirectUrl = 'tsmb:///discount/couponDetail' + allQueryString	+ '&openExternalBrowser=1';
	window.location = encodeURI(redirectUrl);
	setTimeout(function() {
		if (!document.webkitHidden && !dataSet.redirected) {
			dataSet.redirected = true;
			window.location = dataSet.noInstallAppLink;
		}
	}, 1000);	
}
function openApp() {
	var couponCode = getParameterByName('couponCode');
	var allQueryString  = '?couponId='+couponCode;

	if (navigator.userAgent.match(/iPhone|iPad|iPod/i)) {
		openIosApp(allQueryString);
	} else if (navigator.userAgent.match(/Android/i)) {
		openAndroidApp(allQueryString);
	} else {
		window.location = dataSet.pcLink;
	}
}
openApp()
</script>





